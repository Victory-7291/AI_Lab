

# 进阶关卡——第2关作业

    
## 任务1：
### 使用 Lagent 复现文档中 “制作一个属于自己的Agent” 和 “Multi-Agents博客写作系统的搭建”两部分内容，记录复现过程并截图。


使用和风天气服务获取他们的api_key并添加到环境变量，创建lagent中新的action用于查询天气信息，然后在_init_.py中初始化WeatherQuery方法：
  
![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-12-12%2014-13-46.png "2024-11-20%2010-52-40.png")

  
-------------------------------------------------------------------------------------------------------------------

  
在demo.py中引入WeatherQuery方法，在插件初始化列表中添加WeatherQuery

  
![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-12-12%2014-15-42.png "2024-11-20%2016-23-28.png")

  
-------------------------------------------------------------------------------------------------------------------


运行demo：

  
![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-12-12%2014-20-40.png "2024-11-20%2021-42-15.png")

  
-------------------------------------------------------------------------------------------------------------------


创建multi_agents_api_web_demo.py：

  
![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-12-12%2014-29-51.png "2024-11-20%2021-42-31.png")

  
-------------------------------------------------------------------------------------------------------------------


运行博客优化助手：

  
![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-12-15%2017-46-04.png "2024-11-20%2021-43-08.png")

  
-------------------------------------------------------------------------------------------------------------------


### 将Agent应用部署到huggingface space上

  
权重转换：

  
![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-11-23%2022-34-01.png "2024-11-20%2021-42-31.png")

  
-------------------------------------------------------------------------------------------------------------------


得到huggingface格式的权重文件

![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-11-23%2022-33-39.png "2024-11-20%2021-42-15.png")

  
-------------------------------------------------------------------------------------------------------------------


模型合并，将微调得到的adapter层跟原模型文件合并：

![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-11-23%2022-41-44.png "2024-11-20%2021-43-08.png")

  
-------------------------------------------------------------------------------------------------------------------


修改xtuner_streamlit_demo.py：

  
![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-11-23%2022-44-20.png "2024-11-20%2021-43-50.png")

  
-------------------------------------------------------------------------------------------------------------------


运行：

  
![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-11-23%2023-26-31.png "2024-11-20%2021-43-50.png")

  
-------------------------------------------------------------------------------------------------------------------


## 进阶任务：



创建模型仓库和space，并clone到开发机

  
![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-11-24%2022-15-47.png "2024-11-20%2021-42-31.png")

  
-------------------------------------------------------------------------------------------------------------------


上传模型文件：

![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-11-24%2021-59-29.png "2024-11-20%2021-42-15.png")

  
-------------------------------------------------------------------------------------------------------------------


修改streamlit文件的模型路径<br>from transformer import AutoTokenizer,AutoModelForCausalLM<br>
模型路径为“hf_usrname/model_name”

![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-11-24%2021-55-49.png "2024-11-20%2021-43-08.png")

  
-------------------------------------------------------------------------------------------------------------------


git push到space<br>build and deploy<br>没有gpu导致runtime error,gpu需要美元，没有美元。。。

  
![erro](https://github.com/Victory-7291/AI_Lab/raw/main/images/2024-11-24%2021-58-10.png "2024-11-20%2021-43-50.png")

  
-------------------------------------------------------------------------------------------------------------------
